{% macro dlIndexList(params) %}
<table class="dl-index-list{% if params.classes %} {{ params.classes }}{% endif %}">
  <tbody>
{%- for item in params['items'] -%}
{%- set ns = namespace(item_ref="", item_text="") %}

{#- figure out what to use as reference -#}
{%- if params.data_type and item[params.data_type] -%}
  {% set ns.item_ref = item[params.data_type] %}
{%- elif item['reference'] -%}
  {% set ns.item_ref = item['reference'] %}
{%- else -%}
  {% set ns.item_ref = item['slug']|clean_slug %}
{%- endif -%}

{#- figure out what to use as the text/name -#}
{%- if item['site'] -%}
  {% set ns.item_text = item['site'] %}
  {%- if item['site-address'] -%}
    {% set ns.item_text = ns.item_text + ", " + item['site-address'] %}
  {%- endif -%}
{%- elif item['name'] -%}
  {% set ns.item_text = item['name'] %}
{%- else -%}
  {% set ns.item_text = item['text'] %}
{%- endif -%}

<tr>
  <td>
    <h4 class="govuk-heading-s govuk-!-font-weight-regular dl-break-word govuk-!-margin-bottom-0"><a class="govuk-link" href="{{ item['href'] }}">{{ ns.item_ref }}</a></h4>
  </td>
  <td>
    <p class="govuk-body govuk-!-margin-bottom-0">{{ ns.item_text }}</p>
  </td>
</tr>
{%- endfor -%}
</tbody>
</table>
{% endmacro %}